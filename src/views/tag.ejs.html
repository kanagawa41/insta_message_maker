<!DOCTYPE HTML>
<!--
  Spectral by HTML5 UP
  html5up.net | @ajlkn
  Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
  <head>
    <title>タグ | <%= title.jp %></title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="../assets/css/main.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css" />
  </head>
  <body class="is-preload">

    <!-- Page Wrapper -->
      <div id="page-wrapper">

        <!-- Header -->
          <%- include('layout/header.ejs.html') -%>

        <!-- Main -->
          <article id="main">
            <section class="wrapper style5">
              <div class="inner">
                <section>
                  <div class="row">
                    <div class="col-12">
                      <div class="row gtr-uniform">
                        <div class="col-12">
                          <h2>タグ一覧</h2>
                          <div class="row">
                            <div class="col-12" style="padding-bottom: 2em;">
                              <h4 style="color: #21b2a6">タグ1</h4>
                              <div class="row">
                                <div class="col-5">
                                  <input id="tag1-name" name="tag1-name" placeholder="タグ名" type="text">
                                </div>
                              </div>
                              <textarea name="tags1" id="tags1" placeholder="シャープ(#)か空白区切りでタグを入力" rows="3"></textarea>
                            </div>
                            <div class="col-12" style="padding-bottom: 2em;">
                              <h4 style="color: #21b2a6">タグ2</h4>
                              <div class="row">
                                <div class="col-5">
                                  <input id="tag2-name" name="tag2-name" placeholder="タグ名" type="text">
                                </div>
                              </div>
                              <textarea name="tags2" id="tags2" placeholder="シャープ(#)か空白区切りでタグを入力" rows="3"></textarea>
                            </div>
                            <div class="col-12" style="padding-bottom: 2em;">
                              <h4 style="color: #21b2a6">タグ3</h4>
                              <div class="row">
                                <div class="col-5">
                                  <input id="tag3-name" name="tag3-name" placeholder="タグ名" type="text">
                                </div>
                              </div>
                              <textarea name="tags3" id="tags3" placeholder="シャープ(#)か空白区切りでタグを入力" rows="3"></textarea>
                            </div>
                            <div class="col-12" style="padding-bottom: 2em;">
                              <h4 style="color: #21b2a6">タグ4</h4>
                              <div class="row">
                                <div class="col-5">
                                  <input id="tag4-name" name="tag4-name" placeholder="タグ名" type="text">
                                </div>
                              </div>
                              <textarea name="tags4" id="tags4" placeholder="シャープ(#)か空白区切りでタグを入力" rows="3"></textarea>
                            </div>
                          </div>
                        </div>

                        <div class="col-12" style="padding-bottom: 2em;">
                          <ul class="actions fit">
                            <li><a href="#" id="regist-btn" class="make-btn button primary fit" onclick="return false;">登録</a></li>
                          </ul>
                        </div>

                      </div>
                    </div>
                  </div>
                </section>
              </div>
            </section>
          </article>

        <!-- Footer -->
          <%- include('layout/footer.ejs.html') -%>

      </div>

    <!-- Scripts -->
      <script src="../assets/js/main.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>

      <script>
        (function($) {
          const storage = modules.storage_helper.getStorage();
          const keys = modules.storage_helper.keys;

          function init(){
            initLayout();

            loadSetting();

            $('#regist-btn').on('click', function(){
              $('#tag1-name').val(getVal($('#tag1-name').val(), 'タグ1'));
              $('#tags1').val(modules.helper.formatTag($('#tags1').val()));

              $('#tag2-name').val(getVal($('#tag2-name').val(), 'タグ2'));
              $('#tags2').val(modules.helper.formatTag($('#tags2').val()));

              $('#tag3-name').val(getVal($('#tag3-name').val(), 'タグ3'));
              $('#tags3').val(modules.helper.formatTag($('#tags3').val()));

              $('#tag4-name').val(getVal($('#tag4-name').val(), 'タグ4'));
              $('#tags4').val(modules.helper.formatTag($('#tags4').val()));

              function getVal(val, defaultVal){
                if(!val || val.length == 0){ return defaultVal; }
                return val;
              }

              saveSettings();

              toastr.info('タグを保存しました。');
            });

          }

          /**
           * レイアウトの初期処理
           */
          function initLayout(){
            var text = $('#header h1 a').text();
            $('#header h1 a').html(modules.helper.eachTopCharUpper(text, '<span style="color: #21b2a6">', '</span>'));
          };

          /**
           * ストレージの状態を画面に反映
           */
          function loadSetting(){
            if(!storage.getItem(keys.tag_list)){
              modules.strage_helper.setDefaultTags(storage);
              toastr.info('初期値を設定しました。');
            }

            const tagList = JSON.parse(storage.getItem(keys.tag_list));

            $('#tag1-name').val(tagList['tag1_name']);
            $('#tags1').val(tagList['tags1']);
            $('#tag2-name').val(tagList['tag2_name']);
            $('#tags2').val(tagList['tags2']);
            $('#tag3-name').val(tagList['tag3_name']);
            $('#tags3').val(tagList['tags3']);
            $('#tag4-name').val(tagList['tag4_name']);
            $('#tags4').val(tagList['tags4']);
          }

          /**
           * 設定をストレージに保存する
           */
          function saveSettings(){
            var settings = {
              tag1_name: $('#tag1-name').val(),
              tags1: $('#tags1').val(),
              tag2_name: $('#tag2-name').val(),
              tags2: $('#tags2').val(),
              tag3_name: $('#tag3-name').val(),
              tags3: $('#tags3').val(),
              tag4_name: $('#tag4-name').val(),
              tags4: $('#tags4').val(),
            }

            // 設定の保持
            storage.setItem(keys.tag_list, JSON.stringify(settings));
          }

          init();
        })(jQuery);
      </script>

  </body>
</html>